今天开始正式设置 https://rust-lang.cc 的仓库和同步。

主仓库：  
https://gitee.com/maozhonggui/rust-lang.cc  

gitlab 同步仓库(从 gitee pull)  
https://gitlab.com/jackymao/rust-lang.cc  

gitlab 同步到 github 仓库 ( gitlab push to github)  
https://github.com/rust-lang-cc/rust-lang.cc  

三个都是 private 仓库。

首先要确定这三个仓库能全部同步。  
同步方向： gitee --> gitlab --> github  

然后再按照 fly.io 的 github 设置，每次有代码更新到了 github, 用 github action 编译并推送到 fly.io (在 fly.io 已经设置好 https://rust-lang.cc )， 这样就可以在线上直接看到更新了。

如果上面两项都没有问题，那么，以后在本地更新代码，git add . && git commit -m "update" && git push 到 gitee 之后，会自动同步到 gitlab 再自动到 github 再自动到 fly.io. 除了 git push 到 gitee 是实时的，后面的步骤可以要花约一天的时间自动同步，就不强求时效了。  

今天增加了这个 20210801.md 文件，看到明天这个时候能不能同步到 gitlab 和 github. (github 上还没设置 fly.io ，就还不会同步到 fly.io).


2021-08-01 21：03  
刚看到 README.md 文件成功同步到 github 了，邮箱就收到一封邮件，说用地址里面含用户名密码的方式在 2021-08-13 之后不能再用了，要转换为用 token 的方式。不过gitlab 好像还没有用 token 做 mirror push 的设置呢。有点难办。  

https://github.blog/2020-12-15-token-authentication-requirements-for-git-operations/
In July 2020, we announced our intent to require the use of token-based authentication (for example, a personal access, OAuth, or GitHub App installation token) for all authenticated Git operations. Beginning August 13, 2021, we will no longer accept account passwords when authenticating Git operations on GitHub.com.  


https://docs.gitlab.com/ee/user/project/repository/repository_mirroring.html#ssh-authentication  
repository_mirroring ssh-authentication

在 gitlab 重新加一个 mirroring ，地址填 github 的 ssh 地址，然后删除了原 https 同步。 然后可以看到新加的 ssh mirroring 后面有一个点击复制 ssh key 的按钮，点了之后，到 github 的后台增加这个 deploy key.

现在开始专心搞 github action 以在更新的时候自动编译并同步到 fly.io  
https://fly.io/docs/app-guides/continuous-deployment-with-github-actions  
FLY_API_TOKEN  
ALSB01fkue1_QEBmx80M5xVl7G6XmtwVj2FWiUeAy-s  
